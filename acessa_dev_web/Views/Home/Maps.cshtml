@{
    ViewData["Title"] = "Mapa Completo";
    Layout = "_Layout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/styles.css" />
    <link rel="stylesheet" href="~/css/acessibilidade.css" />
    <link rel="stylesheet" href="~/css/maps.css" />
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol/ol.css">
<script src="https://cdn.jsdelivr.net/npm/ol/dist/ol.js"></script>

<style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        font-family: Arial, sans-serif;
    }

    #mapFull {
        width: 100%;
        height: 100vh;
    }

    .btn-voltar {
        position: absolute;
        top: 20px;
        left: 20px;
        background-color: #2563eb;
        color: white;
        border: none;
        padding: 10px 16px;
        border-radius: 8px;
        cursor: pointer;
        z-index: 1000;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    .painel {
        position: absolute;
        top: 20px;
        right: 20px;
        width: 320px;
        background: rgba(255,255,255,0.95);
        border-radius: 10px;
        padding: 12px;
        z-index: 1001;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        overflow-y: auto;
        max-height: 90vh;
    }

        .painel h3 {
            margin-top: 0;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .painel input[type="text"] {
            width: 100%;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #ccc;
            margin-bottom: 8px;
        }

        .painel label {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 6px;
        }

        .painel img {
            width: 18px;
            height: 18px;
        }

    @@media (max-width: 768px) {
        .painel {
            width: 90%;
            left: 5%;
            right: 5%;
            top: 12px;
        }
    }
</style>
<div id="map-popup" class="popup">
    <div class="popup-content">
        <button id="popup-fechar">×</button>
        <div id="popup-titulo"></div>
        <div id="popup-descricao"></div>
        <div class="popup-botoes">
            <button id="btn-avaliar">Avaliar</button>
            <button id="btn-ocorrencia">Registrar Ocorrência</button>
        </div>
    </div>
</div>

<script>
    const popup = document.getElementById("map-popup");
    const fecharPopup = document.getElementById("popup-fechar");

    if (popup && fecharPopup) {
        fecharPopup.addEventListener("click", () => popup.classList.remove("ativo"));
        popup.addEventListener("click", (e) => {
            if (e.target === popup) popup.classList.remove("ativo");
        });
    }

    document.getElementById("btn-avaliar").addEventListener("click", () => {
        window.location.href = "/valiacoes/Index";
    });

    document.getElementById("btn-ocorrencia").addEventListener("click", () => {
        window.location.href = "/Ocorrencias/Index";
    });
</script>

<button class="btn-voltar" onclick="window.history.back()">← Voltar</button>
<div id="mapFull"></div>

<div class="painel">
    <h3>Filtros</h3>
    <input type="text" id="filtroTexto" placeholder="Buscar por nome..." />
    <div id="filtros"></div>
    <small>Dados reais do OpenStreetMap via Overpass API.</small>
</div>

@section Scripts {
    <script src="~/js/acessibilidade.js"></script>
    <script src="~/js/MapScript.js"></script>
}
